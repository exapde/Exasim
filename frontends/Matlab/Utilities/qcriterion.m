function q = qcriterion(u)
%q = - ux^2/2 - vy^2/2 - wz^2/2 - uy*vx - uz*wx - vz*wy;

% ux = (u(:,7,:)  - (u(:,2,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
% uy = (u(:,12,:) - (u(:,2,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
% uz = (u(:,17,:) - (u(:,2,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
% 
% vx = (u(:,8,:)  - (u(:,3,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
% vy = (u(:,13,:) - (u(:,3,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
% vz = (u(:,18,:) - (u(:,3,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
% 
% wx = (u(:,9,:)  - (u(:,4,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
% wy = (u(:,14,:) - (u(:,4,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
% wz = (u(:,19,:) - (u(:,4,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
% 
% q = - ux.^2/2 - vy.^2/2 - wz.^2/2 - uy.*vx - uz.*wx - vz.*wy;

tm = (u(:,7,:)  - (u(:,2,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
q = -0.5*(tm.*tm);

tm = (u(:,13,:) - (u(:,3,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
q = q - 0.5*(tm.*tm);

tm = (u(:,19,:) - (u(:,4,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
q = q - 0.5*(tm.*tm);

tm = (u(:,12,:) - (u(:,2,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
tn = (u(:,8,:)  - (u(:,3,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
q = q - tm.*tn;

tm = (u(:,17,:) - (u(:,2,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
tn = (u(:,9,:)  - (u(:,4,:)./u(:,1,:)).*u(:,6,:))./u(:,1,:);
q = q - tm.*tn;

tm = (u(:,18,:) - (u(:,3,:)./u(:,1,:)).*u(:,16,:))./u(:,1,:);
tn = (u(:,14,:) - (u(:,4,:)./u(:,1,:)).*u(:,11,:))./u(:,1,:);
q = q - tm.*tn;

% normalize 
qmin = min(q(:));
qmax = max(q(:));
q = 2*(q-qmin)/(qmax-qmin) - 1;



