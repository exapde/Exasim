void HdgFbou1(dstype* f, dstype* J1, dstype* J2, dstype* J3, const dstype* x, const dstype* uq, const dstype* v, const dstype* w, const dstype* uhat, const dstype* n, const dstype* tau, const dstype* eta, const dstype* mu, const dstype t, const int modelnumber, const int N, const int szx, const int szuq, const int szv, const int szw, const int szuhat, const int szn, const int sztau, const int szeta, const int szmu)
{

  Kokkos::parallel_for("FbouHdg", N, KOKKOS_LAMBDA(const size_t i) {
    dstype uhat0 = uhat[0*N+i];
    dstype uhat1 = uhat[1*N+i];
    dstype uhat2 = uhat[2*N+i];
    dstype uhat3 = uhat[3*N+i];
    dstype mu4 = mu[4];
    dstype mu5 = mu[5];
    dstype mu6 = mu[6];
    dstype mu7 = mu[7];

    f[0 * N + i] = mu4 - uhat0;
    f[1 * N + i] = mu5 - uhat1;
    f[2 * N + i] = mu6 - uhat2;
    f[3 * N + i] = mu7 - uhat3;
    J1[0 * N + i] = 0;
    J1[1 * N + i] = 0;
    J1[2 * N + i] = 0;
    J1[3 * N + i] = 0;
    J1[4 * N + i] = 0;
    J1[5 * N + i] = 0;
    J1[6 * N + i] = 0;
    J1[7 * N + i] = 0;
    J1[8 * N + i] = 0;
    J1[9 * N + i] = 0;
    J1[10 * N + i] = 0;
    J1[11 * N + i] = 0;
    J1[12 * N + i] = 0;
    J1[13 * N + i] = 0;
    J1[14 * N + i] = 0;
    J1[15 * N + i] = 0;
    J1[16 * N + i] = 0;
    J1[17 * N + i] = 0;
    J1[18 * N + i] = 0;
    J1[19 * N + i] = 0;
    J1[20 * N + i] = 0;
    J1[21 * N + i] = 0;
    J1[22 * N + i] = 0;
    J1[23 * N + i] = 0;
    J1[24 * N + i] = 0;
    J1[25 * N + i] = 0;
    J1[26 * N + i] = 0;
    J1[27 * N + i] = 0;
    J1[28 * N + i] = 0;
    J1[29 * N + i] = 0;
    J1[30 * N + i] = 0;
    J1[31 * N + i] = 0;
    J1[32 * N + i] = 0;
    J1[33 * N + i] = 0;
    J1[34 * N + i] = 0;
    J1[35 * N + i] = 0;
    J1[36 * N + i] = 0;
    J1[37 * N + i] = 0;
    J1[38 * N + i] = 0;
    J1[39 * N + i] = 0;
    J1[40 * N + i] = 0;
    J1[41 * N + i] = 0;
    J1[42 * N + i] = 0;
    J1[43 * N + i] = 0;
    J1[44 * N + i] = 0;
    J1[45 * N + i] = 0;
    J1[46 * N + i] = 0;
    J1[47 * N + i] = 0;
    J3[0 * N + i] = -1;
    J3[1 * N + i] = 0;
    J3[2 * N + i] = 0;
    J3[3 * N + i] = 0;
    J3[4 * N + i] = 0;
    J3[5 * N + i] = -1;
    J3[6 * N + i] = 0;
    J3[7 * N + i] = 0;
    J3[8 * N + i] = 0;
    J3[9 * N + i] = 0;
    J3[10 * N + i] = -1;
    J3[11 * N + i] = 0;
    J3[12 * N + i] = 0;
    J3[13 * N + i] = 0;
    J3[14 * N + i] = 0;
    J3[15 * N + i] = -1;
  });
}

void HdgFbou2(dstype* f, dstype* J1, dstype* J2, dstype* J3, const dstype* x, const dstype* uq, const dstype* v, const dstype* w, const dstype* uhat, const dstype* n, const dstype* tau, const dstype* eta, const dstype* mu, const dstype t, const int modelnumber, const int N, const int szx, const int szuq, const int szv, const int szw, const int szuhat, const int szn, const int sztau, const int szeta, const int szmu)
{

  Kokkos::parallel_for("FbouHdg", N, KOKKOS_LAMBDA(const size_t i) {
    dstype uq0 = uq[0*N+i];
    dstype uq1 = uq[1*N+i];
    dstype uq2 = uq[2*N+i];
    dstype uq3 = uq[3*N+i];
    dstype uhat0 = uhat[0*N+i];
    dstype uhat1 = uhat[1*N+i];
    dstype uhat2 = uhat[2*N+i];
    dstype uhat3 = uhat[3*N+i];

    f[0 * N + i] = -uhat0 + uq0;
    f[1 * N + i] = -uhat1 + uq1;
    f[2 * N + i] = -uhat2 + uq2;
    f[3 * N + i] = -uhat3 + uq3;
    J1[0 * N + i] = 1;
    J1[1 * N + i] = 0;
    J1[2 * N + i] = 0;
    J1[3 * N + i] = 0;
    J1[4 * N + i] = 0;
    J1[5 * N + i] = 1;
    J1[6 * N + i] = 0;
    J1[7 * N + i] = 0;
    J1[8 * N + i] = 0;
    J1[9 * N + i] = 0;
    J1[10 * N + i] = 1;
    J1[11 * N + i] = 0;
    J1[12 * N + i] = 0;
    J1[13 * N + i] = 0;
    J1[14 * N + i] = 0;
    J1[15 * N + i] = 1;
    J1[16 * N + i] = 0;
    J1[17 * N + i] = 0;
    J1[18 * N + i] = 0;
    J1[19 * N + i] = 0;
    J1[20 * N + i] = 0;
    J1[21 * N + i] = 0;
    J1[22 * N + i] = 0;
    J1[23 * N + i] = 0;
    J1[24 * N + i] = 0;
    J1[25 * N + i] = 0;
    J1[26 * N + i] = 0;
    J1[27 * N + i] = 0;
    J1[28 * N + i] = 0;
    J1[29 * N + i] = 0;
    J1[30 * N + i] = 0;
    J1[31 * N + i] = 0;
    J1[32 * N + i] = 0;
    J1[33 * N + i] = 0;
    J1[34 * N + i] = 0;
    J1[35 * N + i] = 0;
    J1[36 * N + i] = 0;
    J1[37 * N + i] = 0;
    J1[38 * N + i] = 0;
    J1[39 * N + i] = 0;
    J1[40 * N + i] = 0;
    J1[41 * N + i] = 0;
    J1[42 * N + i] = 0;
    J1[43 * N + i] = 0;
    J1[44 * N + i] = 0;
    J1[45 * N + i] = 0;
    J1[46 * N + i] = 0;
    J1[47 * N + i] = 0;
    J3[0 * N + i] = -1;
    J3[1 * N + i] = 0;
    J3[2 * N + i] = 0;
    J3[3 * N + i] = 0;
    J3[4 * N + i] = 0;
    J3[5 * N + i] = -1;
    J3[6 * N + i] = 0;
    J3[7 * N + i] = 0;
    J3[8 * N + i] = 0;
    J3[9 * N + i] = 0;
    J3[10 * N + i] = -1;
    J3[11 * N + i] = 0;
    J3[12 * N + i] = 0;
    J3[13 * N + i] = 0;
    J3[14 * N + i] = 0;
    J3[15 * N + i] = -1;
  });
}

void HdgFbou3(dstype* f, dstype* J1, dstype* J2, dstype* J3, const dstype* x, const dstype* uq, const dstype* v, const dstype* w, const dstype* uhat, const dstype* n, const dstype* tau, const dstype* eta, const dstype* mu, const dstype t, const int modelnumber, const int N, const int szx, const int szuq, const int szv, const int szw, const int szuhat, const int szn, const int sztau, const int szeta, const int szmu)
{

  Kokkos::parallel_for("FbouHdg", N, KOKKOS_LAMBDA(const size_t i) {
    dstype uq0 = uq[0*N+i];
    dstype uhat0 = uhat[0*N+i];
    dstype uhat1 = uhat[1*N+i];
    dstype uhat2 = uhat[2*N+i];
    dstype uhat3 = uhat[3*N+i];
    dstype mu8 = mu[8];
    dstype mu9 = mu[9];
    dstype mu10 = mu[10];
    dstype x0 = mu8*mu10/mu9;

    f[0 * N + i] = -uhat0 + uq0;
    f[1 * N + i] = -uhat1;
    f[2 * N + i] = -uhat2;
    f[3 * N + i] = -uhat3 + x0*uhat0;
    J1[0 * N + i] = 1;
    J1[1 * N + i] = 0;
    J1[2 * N + i] = 0;
    J1[3 * N + i] = 0;
    J1[4 * N + i] = 0;
    J1[5 * N + i] = 0;
    J1[6 * N + i] = 0;
    J1[7 * N + i] = 0;
    J1[8 * N + i] = 0;
    J1[9 * N + i] = 0;
    J1[10 * N + i] = 0;
    J1[11 * N + i] = 0;
    J1[12 * N + i] = 0;
    J1[13 * N + i] = 0;
    J1[14 * N + i] = 0;
    J1[15 * N + i] = 0;
    J1[16 * N + i] = 0;
    J1[17 * N + i] = 0;
    J1[18 * N + i] = 0;
    J1[19 * N + i] = 0;
    J1[20 * N + i] = 0;
    J1[21 * N + i] = 0;
    J1[22 * N + i] = 0;
    J1[23 * N + i] = 0;
    J1[24 * N + i] = 0;
    J1[25 * N + i] = 0;
    J1[26 * N + i] = 0;
    J1[27 * N + i] = 0;
    J1[28 * N + i] = 0;
    J1[29 * N + i] = 0;
    J1[30 * N + i] = 0;
    J1[31 * N + i] = 0;
    J1[32 * N + i] = 0;
    J1[33 * N + i] = 0;
    J1[34 * N + i] = 0;
    J1[35 * N + i] = 0;
    J1[36 * N + i] = 0;
    J1[37 * N + i] = 0;
    J1[38 * N + i] = 0;
    J1[39 * N + i] = 0;
    J1[40 * N + i] = 0;
    J1[41 * N + i] = 0;
    J1[42 * N + i] = 0;
    J1[43 * N + i] = 0;
    J1[44 * N + i] = 0;
    J1[45 * N + i] = 0;
    J1[46 * N + i] = 0;
    J1[47 * N + i] = 0;
    J3[0 * N + i] = -1;
    J3[1 * N + i] = 0;
    J3[2 * N + i] = 0;
    J3[3 * N + i] = x0;
    J3[4 * N + i] = 0;
    J3[5 * N + i] = -1;
    J3[6 * N + i] = 0;
    J3[7 * N + i] = 0;
    J3[8 * N + i] = 0;
    J3[9 * N + i] = 0;
    J3[10 * N + i] = -1;
    J3[11 * N + i] = 0;
    J3[12 * N + i] = 0;
    J3[13 * N + i] = 0;
    J3[14 * N + i] = 0;
    J3[15 * N + i] = -1;
  });
}

void HdgFbou4(dstype* f, dstype* J1, dstype* J2, dstype* J3, const dstype* x, const dstype* uq, const dstype* v, const dstype* w, const dstype* uhat, const dstype* n, const dstype* tau, const dstype* eta, const dstype* mu, const dstype t, const int modelnumber, const int N, const int szx, const int szuq, const int szv, const int szw, const int szuhat, const int szn, const int sztau, const int szeta, const int szmu)
{

  Kokkos::parallel_for("FbouHdg", N, KOKKOS_LAMBDA(const size_t i) {
    dstype uq0 = uq[0*N+i];
    dstype uq3 = uq[3*N+i];
    dstype uq4 = uq[4*N+i];
    dstype uq5 = uq[5*N+i];
    dstype uq6 = uq[6*N+i];
    dstype uq7 = uq[7*N+i];
    dstype uq8 = uq[8*N+i];
    dstype uq9 = uq[9*N+i];
    dstype uq10 = uq[10*N+i];
    dstype uq11 = uq[11*N+i];
    dstype v0 = v[0*N+i];
    dstype uhat0 = uhat[0*N+i];
    dstype uhat1 = uhat[1*N+i];
    dstype uhat2 = uhat[2*N+i];
    dstype uhat3 = uhat[3*N+i];
    dstype n0 = n[0*N+i];
    dstype n1 = n[1*N+i];
    dstype tau0 = tau[0];
    dstype mu0 = mu[0];
    dstype mu1 = mu[1];
    dstype mu2 = mu[2];
    dstype mu3 = mu[3];
    dstype mu9 = mu[9];
    dstype x0 = pow(uhat0, -1);
    dstype x1 = pow(uhat0, -2);
    dstype x2 = pow(uhat2, 2);
    dstype x3 = x2*x1;
    dstype x4 = pow(uhat1, 2);
    dstype x5 = x1*x4;
    dstype x6 = 0.5*(x3 + x5);
    dstype x7 = uhat3 - x6*uhat0;
    dstype x8 = -1.0 + mu0;
    dstype x9 = x0*x8;
    dstype x10 = x7*x9;
    dstype x11 = 1.0*mu0;
    dstype x12 = pow(mu3, 2)*mu9;
    dstype x13 = x12*x11;
    dstype x14 = 110.4 + x13*x10;
    dstype x15 = pow(x14, -1);
    dstype x16 = pow(mu1, -1);
    dstype x17 = 110.4 + mu9;
    dstype x18 = pow(uhat0, -3);
    dstype x19 = pow(mu3, 6);
    dstype x20 = pow(x8, 3)*x19*pow(mu0, 3);
    dstype x21 = pow(x7, 3)*x20;
    dstype x22 = sqrt(x21*x18);
    dstype x23 = x22*x17*x16;
    dstype x24 = x23*x15;
    dstype x25 = x0*x24;
    dstype x26 = x0*uq4;
    dstype x27 = uq5 - x26*uhat1;
    dstype x28 = x0*x27;
    dstype x29 = x0*uq8;
    dstype x30 = uq10 - x29*uhat2;
    dstype x31 = x0*x30;
    dstype x32 = -x28 + 2*x31;
    dstype x33 = 0.666666666666667*x32;
    dstype x34 = x33*x25;
    dstype x35 = uq6 - x26*uhat2;
    dstype x36 = uq9 - x29*uhat1;
    dstype x37 = x0*x35 + x0*x36;
    dstype x38 = 1.0*x25;
    dstype x39 = x38*x37;
    dstype x40 = x10 + x0*uhat3;
    dstype x41 = x8*x7;
    dstype x42 = x1*x30;
    dstype x43 = x42*uhat2;
    dstype x44 = x1*x36;
    dstype x45 = x44*uhat1;
    dstype x46 = x8*(uq11 - x6*uq8 - (x43 + x45)*uhat0);
    dstype x47 = -uq8*x41 + x46*uhat0;
    dstype x48 = 1.0*x1;
    dstype x49 = x48*x24;
    dstype x50 = pow(x8, -1);
    dstype x51 = pow(mu2, -1);
    dstype x52 = x51*mu0;
    dstype x53 = x50*x52;
    dstype x54 = x53*x49;
    dstype x55 = x1*x35;
    dstype x56 = x55*uhat2;
    dstype x57 = x1*x27;
    dstype x58 = x57*uhat1;
    dstype x59 = x8*(uq7 - x6*uq4 - (x56 + x58)*uhat0);
    dstype x60 = -uq4*x41 + x59*uhat0;
    dstype x61 = 2*x28 - x31;
    dstype x62 = 0.666666666666667*x25;
    dstype x63 = x61*x62;
    dstype x64 = x4*x18;
    dstype x65 = 1.33333333333333*x24;
    dstype x66 = x2*x18;
    dstype x67 = 1.0*x24;
    dstype x68 = -0.5*x3 - 0.5*x5;
    dstype x69 = x8*uhat0;
    dstype x70 = x54*(-x41 + x69*(x68 - (-x64 - x66)*uhat0));
    dstype x71 = uhat2*uhat1;
    dstype x72 = x71*x18;
    dstype x73 = 0.333333333333333*x72*x24;
    dstype x74 = x1*uhat1;
    dstype x75 = x49*uhat1;
    dstype x76 = -x75*x52;
    dstype x77 = x1*uhat2;
    dstype x78 = 0.666666666666667*x24;
    dstype x79 = x49*uhat2;
    dstype x80 = -x79*x52;
    dstype x81 = v0 + x51*x25*x11;
    dstype x82 = x78*x74;
    dstype x83 = x1*x41;
    dstype x84 = 0.5*(-2*x64 - 2*x66);
    dstype x85 = x68 - x84*uhat0;
    dstype x86 = x9*x85;
    dstype x87 = x23/pow(x14, 2);
    dstype x88 = (-x83*x13 + x86*x13)*x87;
    dstype x89 = x0*x88;
    dstype x90 = x61*uhat1;
    dstype x91 = pow(x7, 2);
    dstype x92 = x91*x20;
    dstype x93 = pow(uhat0, -4);
    dstype x94 = x15*x17*x16/x22;
    dstype x95 = x94*(-3*x93*x21 + 3*x85*x92*x18);
    dstype x96 = 0.333333333333333*x0;
    dstype x97 = 2*x18;
    dstype x98 = x97*uhat1;
    dstype x99 = x97*uhat2;
    dstype x100 = uq4*x93;
    dstype x101 = x8*x85;
    dstype x102 = x0*x37;
    dstype x103 = x88*x102;
    dstype x104 = 1.0*uhat2;
    dstype x105 = x60*x53;
    dstype x106 = x88*x48;
    dstype x107 = uq8*x18;
    dstype x108 = x107*uhat1;
    dstype x109 = uq4*x18;
    dstype x110 = x109*uhat2;
    dstype x111 = (x108 + x110 - x44 - x55)*x38;
    dstype x112 = x52*x24;
    dstype x113 = 2.0*x50*x112;
    dstype x114 = x60*x18;
    dstype x115 = -x83 + x86 - x1*uhat3;
    dstype x116 = x109*uhat1;
    dstype x117 = x107*uhat2;
    dstype x118 = -x117 + x42;
    dstype x119 = x95*uhat2;
    dstype x120 = 0.5*x102;
    dstype x121 = 0.5*x1*x95;
    dstype x122 = 1.0*uhat1;
    dstype x123 = x47*x18;
    dstype x124 = x77*x33;
    dstype x125 = -x116 + x57;
    dstype x126 = x53*x47;
    dstype x127 = uq8*x93;
    dstype x128 = x87*x12;
    dstype x129 = mu0*x128;
    dstype x130 = x8*x129;
    dstype x131 = 0.666666666666667*x61*x130;
    dstype x132 = x92*x94;
    dstype x133 = x61*x132;
    dstype x134 = pow(uhat0, -5);
    dstype x135 = 1.0*x134;
    dstype x136 = x133*x135;
    dstype x137 = 1.0*x8;
    dstype x138 = x93*x122;
    dstype x139 = x51*pow(mu0, 2)*x128;
    dstype x140 = x60*x139;
    dstype x141 = uq4*x48;
    dstype x142 = 1.0*x9;
    dstype x143 = uq4*x142;
    dstype x144 = pow(x8, 2)*x51*x91*x94*x19*pow(mu0, 4);
    dstype x145 = x60*x144;
    dstype x146 = pow(uhat0, -6);
    dstype x147 = 1.5*uhat1;
    dstype x148 = x146*x147;
    dstype x149 = 1.5*x134;
    dstype x150 = x37*x132*x149;
    dstype x151 = x137*uhat2;
    dstype x152 = x37*x129;
    dstype x153 = x151*x152;
    dstype x154 = x40 - x71*x150 + x18*x153*uhat1;
    dstype x155 = x47*x139;
    dstype x156 = x47*x144;
    dstype x157 = uq8*x48;
    dstype x158 = uq8*x142;
    dstype x159 = x137*x152;
    dstype x160 = x32*x132*x135;
    dstype x161 = x33*x130;
    dstype x162 = x39 - x74*x151;
    dstype x163 = x93*x104;
    dstype x164 = 1.5*uhat2;
    dstype x165 = x164*x146;
    dstype x166 = x0 + x9;
    dstype x167 = x93*x132;
    dstype x168 = x37*x167;
    dstype x169 = 1.0*x139;

    f[0 * N + i] = -uhat0 + uq0;
    f[1 * N + i] = -uhat1;
    f[2 * N + i] = -uhat2;
    f[3 * N + i] = n0*(v0*uq7 + x39*uhat2 + x40*uhat1 + x60*x54 + x63*uhat1) + n1*(v0*uq11 + x34*uhat2 + x39*uhat1 + x40*uhat2 + x54*x47) + tau0*(-uhat3 + uq3);
    J1[0 * N + i] = 1;
    J1[1 * N + i] = 0;
    J1[2 * N + i] = 0;
    J1[3 * N + i] = 0;
    J1[4 * N + i] = 0;
    J1[5 * N + i] = 0;
    J1[6 * N + i] = 0;
    J1[7 * N + i] = 0;
    J1[8 * N + i] = 0;
    J1[9 * N + i] = 0;
    J1[10 * N + i] = 0;
    J1[11 * N + i] = 0;
    J1[12 * N + i] = 0;
    J1[13 * N + i] = 0;
    J1[14 * N + i] = 0;
    J1[15 * N + i] = tau0;
    J1[16 * N + i] = 0;
    J1[17 * N + i] = 0;
    J1[18 * N + i] = 0;
    J1[19 * N + i] = n0*(x70 - x64*x65 - x67*x66) - n1*x73;
    J1[20 * N + i] = 0;
    J1[21 * N + i] = 0;
    J1[22 * N + i] = 0;
    J1[23 * N + i] = n0*(x76 + x74*x65) - n1*x78*x77;
    J1[24 * N + i] = 0;
    J1[25 * N + i] = 0;
    J1[26 * N + i] = 0;
    J1[27 * N + i] = n1*x75 + (x79 + x80)*n0;
    J1[28 * N + i] = 0;
    J1[29 * N + i] = 0;
    J1[30 * N + i] = 0;
    J1[31 * N + i] = n0*x81;
    J1[32 * N + i] = 0;
    J1[33 * N + i] = 0;
    J1[34 * N + i] = 0;
    J1[35 * N + i] = -n0*x73 + n1*(x70 - x64*x67 - x65*x66);
    J1[36 * N + i] = 0;
    J1[37 * N + i] = 0;
    J1[38 * N + i] = 0;
    J1[39 * N + i] = n0*x79 + (x75 + x76)*n1;
    J1[40 * N + i] = 0;
    J1[41 * N + i] = 0;
    J1[42 * N + i] = 0;
    J1[43 * N + i] = -n0*x82 + n1*(x80 + x77*x65);
    J1[44 * N + i] = 0;
    J1[45 * N + i] = 0;
    J1[46 * N + i] = 0;
    J1[47 * N + i] = n1*x81;
    J3[0 * N + i] = -1;
    J3[1 * N + i] = 0;
    J3[2 * N + i] = 0;
    J3[3 * N + i] = n0*(-x103*x104 - x105*x106 + x105*x121 + x111*uhat2 - x113*x114 + x115*uhat1 + x119*x120 + x54*(x59 - uq4*x101 + x69*(-x56 - x58 - uq4*x84 - (x2*x100 + x4*x100 - x98*x27 - x99*x35)*uhat0)) - x79*x37 - x82*x61 - 0.666666666666667*x89*x90 + x62*(2*x116 + x118 - 2*x57)*uhat1 + x90*x96*x95) + n1*(-x103*x122 - x106*x126 + x111*uhat1 - x113*x123 + x115*uhat2 + x121*x126 - x24*x124 + x54*(x46 - uq8*x101 + x69*(-x43 - x45 - uq8*x84 - (x2*x127 + x4*x127 - x98*x36 - x99*x30)*uhat0)) - x75*x37 + x62*(2*x117 + x125 - 2*x42)*uhat2 - x89*x33*uhat2 + x95*x120*uhat1 + x96*x32*x119);
    J3[4 * N + i] = 0;
    J3[5 * N + i] = -1;
    J3[6 * N + i] = 0;
    J3[7 * N + i] = n0*(x154 + x63 + x138*x140 - x145*x148 - x4*x136 - x5*x137 + x54*(x143*uhat1 + (-x125*uhat0 - x141*uhat1)*x69) + x64*x131 - x65*x116 - x67*x117) + n1*(x162 + x138*x155 - x148*x156 - x4*x150 + x54*(x158*uhat1 + x69*(-x157*uhat1 - (-x108 + x44)*uhat0)) + x64*x159 - x67*x108 - x71*x160 + x72*x161 + x78*x110);
    J3[8 * N + i] = 0;
    J3[9 * N + i] = 0;
    J3[10 * N + i] = -1;
    J3[11 * N + i] = n0*(x162 + x163*x140 - x165*x145 - x2*x150 + x54*(x143*uhat2 + x69*(-x141*uhat2 - (-x110 + x55)*uhat0)) + x66*x159 - x67*x110 - x71*x136 + x72*x131 + x78*x108) + n1*(x154 + x34 + x163*x155 - x165*x156 - x2*x160 - x3*x137 + x54*(x158*uhat2 + (-x118*uhat0 - x157*uhat2)*x69) - x65*x117 + x66*x161 - x67*x116);
    J3[12 * N + i] = 0;
    J3[13 * N + i] = 0;
    J3[14 * N + i] = 0;
    J3[15 * N + i] = -tau0 + n0*(-x1*x153 - x112*x141 - x114*x169 + x133*x138 + x145*x149 + x166*uhat1 + x168*x164 - x74*x131) + n1*(-x112*x157 - x123*x169 - x124*x130 + x149*x156 + x166*uhat2 + x168*x147 - x74*x159 + x32*x104*x167);
  });
}

void HdgFbou5(dstype* f, dstype* J1, dstype* J2, dstype* J3, const dstype* x, const dstype* uq, const dstype* v, const dstype* w, const dstype* uhat, const dstype* n, const dstype* tau, const dstype* eta, const dstype* mu, const dstype t, const int modelnumber, const int N, const int szx, const int szuq, const int szv, const int szw, const int szuhat, const int szn, const int sztau, const int szeta, const int szmu)
{

  Kokkos::parallel_for("FbouHdg", N, KOKKOS_LAMBDA(const size_t i) {
    dstype uq0 = uq[0*N+i];
    dstype v1 = v[1*N+i];
    dstype uhat0 = uhat[0*N+i];
    dstype uhat1 = uhat[1*N+i];
    dstype uhat2 = uhat[2*N+i];
    dstype uhat3 = uhat[3*N+i];

    f[0 * N + i] = -uhat0 + uq0;
    f[1 * N + i] = -uhat1;
    f[2 * N + i] = -uhat2;
    f[3 * N + i] = -uhat3 + v1*uhat0;
    J1[0 * N + i] = 1;
    J1[1 * N + i] = 0;
    J1[2 * N + i] = 0;
    J1[3 * N + i] = 0;
    J1[4 * N + i] = 0;
    J1[5 * N + i] = 0;
    J1[6 * N + i] = 0;
    J1[7 * N + i] = 0;
    J1[8 * N + i] = 0;
    J1[9 * N + i] = 0;
    J1[10 * N + i] = 0;
    J1[11 * N + i] = 0;
    J1[12 * N + i] = 0;
    J1[13 * N + i] = 0;
    J1[14 * N + i] = 0;
    J1[15 * N + i] = 0;
    J1[16 * N + i] = 0;
    J1[17 * N + i] = 0;
    J1[18 * N + i] = 0;
    J1[19 * N + i] = 0;
    J1[20 * N + i] = 0;
    J1[21 * N + i] = 0;
    J1[22 * N + i] = 0;
    J1[23 * N + i] = 0;
    J1[24 * N + i] = 0;
    J1[25 * N + i] = 0;
    J1[26 * N + i] = 0;
    J1[27 * N + i] = 0;
    J1[28 * N + i] = 0;
    J1[29 * N + i] = 0;
    J1[30 * N + i] = 0;
    J1[31 * N + i] = 0;
    J1[32 * N + i] = 0;
    J1[33 * N + i] = 0;
    J1[34 * N + i] = 0;
    J1[35 * N + i] = 0;
    J1[36 * N + i] = 0;
    J1[37 * N + i] = 0;
    J1[38 * N + i] = 0;
    J1[39 * N + i] = 0;
    J1[40 * N + i] = 0;
    J1[41 * N + i] = 0;
    J1[42 * N + i] = 0;
    J1[43 * N + i] = 0;
    J1[44 * N + i] = 0;
    J1[45 * N + i] = 0;
    J1[46 * N + i] = 0;
    J1[47 * N + i] = 0;
    J3[0 * N + i] = -1;
    J3[1 * N + i] = 0;
    J3[2 * N + i] = 0;
    J3[3 * N + i] = v1;
    J3[4 * N + i] = 0;
    J3[5 * N + i] = -1;
    J3[6 * N + i] = 0;
    J3[7 * N + i] = 0;
    J3[8 * N + i] = 0;
    J3[9 * N + i] = 0;
    J3[10 * N + i] = -1;
    J3[11 * N + i] = 0;
    J3[12 * N + i] = 0;
    J3[13 * N + i] = 0;
    J3[14 * N + i] = 0;
    J3[15 * N + i] = -1;
  });
}

void HdgFbou(dstype* f, dstype* f_udg, dstype* f_wdg, dstype* f_uhg, const dstype* xdg, const dstype* udg, const dstype* odg, const dstype* wdg, const dstype* uhg,
           const dstype* nlg, const dstype* tau, const dstype* uinf, const dstype* param, const dstype time,
           const int modelnumber, const int ib, const int ng, const int nc, const int ncu, const int nd,
           const int ncx, const int nco, const int ncw) {
    if (ib == 1 )
        HdgFbou1(f, f_udg, f_wdg, f_uhg, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, modelnumber,
                        ng, nc, ncu, nd, ncx, nco, ncw, nc, ncu, nd);
    else if (ib == 2 )
        HdgFbou2(f, f_udg, f_wdg, f_uhg, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, modelnumber,
                        ng, nc, ncu, nd, ncx, nco, ncw, nc, ncu, nd);
    else if (ib == 3 )
        HdgFbou3(f, f_udg, f_wdg, f_uhg, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, modelnumber,
                        ng, nc, ncu, nd, ncx, nco, ncw, nc, ncu, nd);
    else if (ib == 4 )
        HdgFbou4(f, f_udg, f_wdg, f_uhg, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, modelnumber,
                        ng, nc, ncu, nd, ncx, nco, ncw, nc, ncu, nd);
    else if (ib == 5 )
        HdgFbou5(f, f_udg, f_wdg, f_uhg, xdg, udg, odg, wdg, uhg, nlg, tau, uinf, param, time, modelnumber,
                        ng, nc, ncu, nd, ncx, nco, ncw, nc, ncu, nd);
}
